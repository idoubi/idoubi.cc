<!DOCTYPE html>
<html lang="cn-zh">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>golang版本的curl请求库 - 艾逗笔</title>
    <meta property="og:title" content="golang版本的curl请求库 - 艾逗笔">
    
    <meta name="twitter:card" content="summary">

    
      
    

    
      
      <meta property="description" content="https://github.com/mikemintang/go-curl
[&amp;hellip;] go get github.com/mikemintang/go-curl 使用 package main import ( &amp;#34;fmt&amp;#34; &amp;#34;github.com/mikemintang/go-curl&amp;#34; ) func main() { url := &amp;hellip;">
      <meta property="og:description" content="https://github.com/mikemintang/go-curl
[&amp;hellip;] go get github.com/mikemintang/go-curl 使用 package main import ( &amp;#34;fmt&amp;#34; &amp;#34;github.com/mikemintang/go-curl&amp;#34; ) func main() { url := &amp;hellip;">
      
    

    
    
    <meta name="twitter:image" content="http://blogcdn.idoustudio.com/go-curl-2.png">
    
    

    

    
    


<link href='//cdn.bootcss.com/highlight.js/9.12.0/styles/github.min.css' rel='stylesheet' type='text/css' />



    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
  </head>

  
  <body class="posts">
    <header class="masthead">
      <h1><a href="/">艾逗笔</a></h1>

<p class="tagline">有逻辑的脑子万里挑一。</p>

      <nav class="menu">
  <input id="menu-check" type="checkbox" hidden/>
  <label id="menu-label" for="menu-check" class="unselectable" hidden>
    <span class="icon close-icon">✕</span>
    <span class="icon open-icon">☰</span>
    <span class="text">Menu</span>
  </label>
  <ul>
  
  
  <li><a href="/">首页</a></li>
  
  <li><a href="/categories/">分类</a></li>
  
  <li><a href="/tags/">标签</a></li>
  
  <li><a href="/works/">作品</a></li>
  
  <li><a href="/about/">关于</a></li>
  
  
  </ul>
</nav>

    </header>

    <article class="main">
      <header class="title">
      
<h1>golang版本的curl请求库</h1>

<h3>
  2017-09-14</h3>
<hr>


      </header>



<h2 id="github地址">Github地址</h2>
<p><a href="https://github.com/mikemintang/go-curl">https://github.com/mikemintang/go-curl</a></p>
<h2 id="安装">安装</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#66d9ef">go</span> <span style="color:#a6e22e">get</span> <span style="color:#a6e22e">github</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/</span><span style="color:#a6e22e">mikemintang</span><span style="color:#f92672">/</span><span style="color:#66d9ef">go</span><span style="color:#f92672">-</span><span style="color:#a6e22e">curl</span>
</code></pre></div><h2 id="使用">使用</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> (
    <span style="color:#e6db74">&#34;fmt&#34;</span>
    <span style="color:#e6db74">&#34;github.com/mikemintang/go-curl&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {

    <span style="color:#a6e22e">url</span> <span style="color:#f92672">:=</span> <span style="color:#e6db74">&#34;http://php.dev/api.php&#34;</span>

    <span style="color:#a6e22e">headers</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">string</span>{
        <span style="color:#e6db74">&#34;User-Agent&#34;</span>:    <span style="color:#e6db74">&#34;Sublime&#34;</span>,
        <span style="color:#e6db74">&#34;Authorization&#34;</span>: <span style="color:#e6db74">&#34;Bearer access_token&#34;</span>,
        <span style="color:#e6db74">&#34;Content-Type&#34;</span>:  <span style="color:#e6db74">&#34;application/json&#34;</span>,
    }

    <span style="color:#a6e22e">cookies</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">string</span>{
        <span style="color:#e6db74">&#34;userId&#34;</span>:    <span style="color:#e6db74">&#34;12&#34;</span>,
        <span style="color:#e6db74">&#34;loginTime&#34;</span>: <span style="color:#e6db74">&#34;15045682199&#34;</span>,
    }

    <span style="color:#a6e22e">queries</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">string</span>{
        <span style="color:#e6db74">&#34;page&#34;</span>: <span style="color:#e6db74">&#34;2&#34;</span>,
        <span style="color:#e6db74">&#34;act&#34;</span>:  <span style="color:#e6db74">&#34;update&#34;</span>,
    }

    <span style="color:#a6e22e">postData</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">interface</span>{}{
        <span style="color:#e6db74">&#34;name&#34;</span>:      <span style="color:#e6db74">&#34;mike&#34;</span>,
        <span style="color:#e6db74">&#34;age&#34;</span>:       <span style="color:#ae81ff">24</span>,
        <span style="color:#e6db74">&#34;interests&#34;</span>: []<span style="color:#66d9ef">string</span>{<span style="color:#e6db74">&#34;basketball&#34;</span>, <span style="color:#e6db74">&#34;reading&#34;</span>, <span style="color:#e6db74">&#34;coding&#34;</span>},
        <span style="color:#e6db74">&#34;isAdmin&#34;</span>:   <span style="color:#66d9ef">true</span>,
    }

    <span style="color:#75715e">// 链式操作
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">req</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">curl</span>.<span style="color:#a6e22e">NewRequest</span>()
    <span style="color:#a6e22e">resp</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">req</span>.
        <span style="color:#a6e22e">SetUrl</span>(<span style="color:#a6e22e">url</span>).
        <span style="color:#a6e22e">SetHeaders</span>(<span style="color:#a6e22e">headers</span>).
        <span style="color:#a6e22e">SetCookies</span>(<span style="color:#a6e22e">cookies</span>).
        <span style="color:#a6e22e">SetQueries</span>(<span style="color:#a6e22e">queries</span>).
        <span style="color:#a6e22e">SetPostData</span>(<span style="color:#a6e22e">postData</span>).
        <span style="color:#a6e22e">Post</span>()

    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">err</span>)
    } <span style="color:#66d9ef">else</span> {
        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">resp</span>.<span style="color:#a6e22e">IsOk</span>() {
            <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">resp</span>.<span style="color:#a6e22e">Body</span>)
        } <span style="color:#66d9ef">else</span> {
            <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">resp</span>.<span style="color:#a6e22e">Raw</span>)
        }
    }

}

</code></pre></div><h2 id="接收请求的apiphp">接收请求的api.php</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#f92672">&lt;?</span><span style="color:#a6e22e">php</span>  

<span style="color:#75715e">//echo json_encode($_GET);                      // 获取url地址中的查询参数
</span><span style="color:#75715e">//echo json_encode(getallheaders());            // 获取请求头
</span><span style="color:#75715e">//echo json_encode($_COOKIE);                   // 获取cookies
</span><span style="color:#75715e"></span><span style="color:#66d9ef">echo</span> <span style="color:#a6e22e">file_get_contents</span>(<span style="color:#e6db74">&#34;php://input&#34;</span>);          <span style="color:#75715e">// 获取post提交的数据
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getallheaders</span>() { 
    $headers <span style="color:#f92672">=</span> []; 
    <span style="color:#66d9ef">foreach</span> ($_SERVER <span style="color:#66d9ef">as</span> $name <span style="color:#f92672">=&gt;</span> $value) { 
       <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">substr</span>($name, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">5</span>) <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;HTTP_&#39;</span>) { 
           $headers[<span style="color:#a6e22e">str_replace</span>(<span style="color:#e6db74">&#39; &#39;</span>, <span style="color:#e6db74">&#39;-&#39;</span>, <span style="color:#a6e22e">ucwords</span>(<span style="color:#a6e22e">strtolower</span>(<span style="color:#a6e22e">str_replace</span>(<span style="color:#e6db74">&#39;_&#39;</span>, <span style="color:#e6db74">&#39; &#39;</span>, <span style="color:#a6e22e">substr</span>($name, <span style="color:#ae81ff">5</span>)))))] <span style="color:#f92672">=</span> $value; 
       } 
    } 
    <span style="color:#66d9ef">return</span> $headers; 
} 
</code></pre></div><h2 id="可导出的成员变量和方法">可导出的成员变量和方法</h2>
<p><img src="http://blogcdn.idoustudio.com/go-curl-2.png" alt=""></p>
<h2 id="todolist">TodoList</h2>
<ul>
<li><input checked="" disabled="" type="checkbox"> 以链式操作的方式发起请求</li>
<li><input disabled="" type="checkbox"> 以函数回调的方式发起请求</li>
<li><input disabled="" type="checkbox"> 以类Jquery Ajax的方式发起请求</li>
<li><input checked="" disabled="" type="checkbox"> 发起GET/POST请求</li>
<li><input disabled="" type="checkbox"> 发起PUT/PATCH/DELETE/OPTIONS操作</li>
<li><input checked="" disabled="" type="checkbox"> 以application/x-www-form-urlencoded形式提交post数据</li>
<li><input checked="" disabled="" type="checkbox"> 以application/json形式提交post数据</li>
<li><input disabled="" type="checkbox"> 以multipart/form-data形式提交post数据</li>
<li><input disabled="" type="checkbox"> proxy代理设置</li>
</ul>



<img src="http://blogcdn.idoustudio.com/idoubi-mp.jpeg" width="320" alt="">



<script src="https://utteranc.es/client.js"
        repo="idoubi/idoubi.github.io"
        issue-term="title"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>


  <footer>
  
  



<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/tex.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



  
  <hr>
  <div class="copyright">© <a href="https://idoubi.cc">艾逗笔</a> 2020 | <a href="https://github.com/idoubi">Github</a></div>
  
  </footer>
  </article>
  
  </body>
</html>

